unit uWkUtils;

interface

uses System.StrUtils, System.SysUtils, Vcl.Dialogs;

const
    MESSAGEFIXO1 =
      'Problema ao executar comando, contate o administador do sistema, '+
      'e informe o erro a seguir:';

    MESSAGEEXCEPCOMPCONTROL =
      'Erro de controle do componente, ' + MESSAGEFIXO1;

    MESSAGECARREGAPEDIDOSVALCLIENTE =
      'Para carregar os pedidos, o código do cliente não pode ser informado.';


  function ArredValores(value: double;casas : integer): double;

implementation

function ArredValores(value: double;casas : integer): double;
Var
fracao, Total:real;
decimal:string;
begin
  Result := 0;
  if value = 0 then
    Exit;
    try
      //Retorna a parte fracionária de um número
      fracao:=Frac(value);
      //decimal recebe a parte decimal
      decimal:=(RightStr(floattostr(fracao),length(floattostr(fracao))-2));
      //Enquanto o tamanho da variavel decimal for maior que o número
      //de casas faça
      while length(decimal) > casas do
      begin
        //Verifica se o último digito da variável decimal é maior que 5
        if strtoint(RightStr(decimal,1))>5 then
        begin
          //Descarta o último digito da variável Decimal
          decimal:=leftstr(decimal,length(decimal)-1);
          //Soma o valor número da variavel decimal + 1
          decimal:=floattostr(strtofloat(decimal) + 1);
        end else
        //Descarta o último digito da variável Decimal
        decimal:=leftstr(decimal,length(decimal)-1);
      end;
      //devolve o resultado para a função
      result:=(int(value) + (strtofloat(decimal)/100));
    except on e : exception do
        ShowMessage(e.Message);
    end;

end;

end.
